const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/AIQuestionGenerator-DOtiIo6i.js","assets/index-D5d0iPnG.js","assets/index-B0wimEEK.css","assets/AIQuestionGenerator--IHrACF-.css","assets/AIQuestionGenerator-Cc29iW0U.css"])))=>i.map(i=>d[i]);
import{u as w,a as _,r,j as e,R as z,_ as E}from"./index-D5d0iPnG.js";import{s as l}from"./socket-q9tp1uyO.js";const $=z.lazy(()=>E(()=>import("./AIQuestionGenerator-DOtiIo6i.js"),__vite__mapDeps([0,1,2,3,4])));function L(){const{user:s,logout:v}=w(),d=_(),[m,N]=r.useState(""),[p,x]=r.useState([]),[f,u]=r.useState(!1),[C,g]=r.useState(!1),[h,A]=r.useState(""),[j,S]=r.useState([]),[y,c]=r.useState(""),[b,i]=r.useState("");r.useEffect(()=>{T()},[]);const T=async()=>{try{const t=await(await fetch("https://backend-v1-2nej.onrender.com/api/games")).json(),o=Array.isArray(t)?t:[];x(o)}catch(a){console.error("Error fetching games:",a),x([])}},G=async()=>{if(!h){i("Por favor selecciona un tema antes de crear la partida."),setTimeout(()=>i(""),4e3);return}if(!j.length){i("Primero debes generar preguntas con IA antes de crear la partida."),setTimeout(()=>i(""),4e3);return}const a=j.map(t=>({...t,category:h}));u(!0),l.connect();let n=null;s&&s.getIdToken&&(n=await s.getIdToken()),l.emit("createGame",{hostId:s.uid,displayName:s.displayName||s.email,isPublic:!0,token:n,topic:h,questions:a,count:a.length}),l.on("gameCreated",({gameId:t,questions:o})=>{u(!1),c(`¡Tu partida fue creada con ${(o==null?void 0:o.length)||0} preguntas! Invita a tus amigos y disfruta. 🚀`),setTimeout(()=>c(""),5e3),setTimeout(()=>d(`/lobby/${t}`),1200)}),l.on("error",({error:t})=>{u(!1),i("Ocurrió un error al crear la partida: "+t),setTimeout(()=>i(""),5e3)})},I=()=>{if(!m.trim()){i("Por favor ingresa un código de partida."),setTimeout(()=>i(""),4e3);return}d(`/lobby/${m}`)},P=a=>{c("¡Te uniste a la partida! Cargando sala..."),setTimeout(()=>c(""),4e3),setTimeout(()=>d(`/lobby/${a}`),1200)},k=a=>{var n;S(a),a&&a.length>0&&a[0].category&&A(a[0].category),c(`¡Listo! Se generaron ${a.length} preguntas para el tema "${((n=a[0])==null?void 0:n.category)||""}". 🎉`),setTimeout(()=>c(""),5e3)};return e.jsxs("div",{className:"dashboard-page",children:[(y||b)&&e.jsx("div",{style:{position:"fixed",top:24,left:"50%",transform:"translateX(-50%)",zIndex:2e3,background:b?"rgba(239,68,68,0.97)":"rgba(99,102,241,0.95)",color:"#fff",padding:"1.1rem 2.2rem",borderRadius:18,fontWeight:700,fontSize:"1.15rem",boxShadow:"0 4px 24px rgba(42,122,228,0.18)",border:"2px solid #fff",letterSpacing:.5,textAlign:"center",animation:"fadeIn 0.5s"},children:b||y}),e.jsx("header",{className:"dashboard-header",children:e.jsxs("div",{className:"user-info",children:[e.jsxs("h2",{children:["¡Bienvenido, ",(s==null?void 0:s.displayName)||(s==null?void 0:s.email),"!"]}),e.jsxs("div",{className:"user-actions",children:[e.jsx("button",{onClick:()=>d("/profile"),className:"btn btn-secondary",children:"Perfil"}),e.jsx("button",{onClick:v,className:"btn btn-outline",children:"Cerrar sesión"})]}),e.jsx("style",{children:`
            .btn, .btn-primary, .btn-secondary, .btn-outline, .btn-ai {
              min-width: 140px !important;
              font-size: 1.08rem !important;
              white-space: nowrap !important;
            }
          `})]})}),e.jsxs("main",{className:"dashboard-main",children:[e.jsxs("div",{className:"game-actions",children:[e.jsxs("div",{className:"create-game-section",children:[e.jsx("h3",{children:"🎮 Crear nueva partida"}),e.jsx("p",{children:"Inicia una partida y invita a tus amigos"}),e.jsxs("div",{className:"create-game-actions",children:[e.jsx("button",{onClick:G,className:"btn btn-primary btn-large",disabled:f,title:"Primero genera preguntas con IA para que tu partida tenga contenido.",children:f?"Creando...":"Crear partida"}),e.jsx("button",{onClick:()=>g(!0),className:"btn btn-ai btn-large",title:"Genera preguntas personalizadas antes de crear tu partida.",children:"🤖 Generar preguntas"}),e.jsxs("div",{style:{marginTop:8,color:"#555",fontSize:14},children:[e.jsx("strong",{children:"Ayuda:"})," Antes de crear una partida, puedes generar preguntas automáticamente o agregar preguntas manuales personalizadas. Así tu juego tendrá contenido único, reciente y adaptado a tus necesidades."]})]})]}),e.jsxs("div",{className:"join-game-section",children:[e.jsx("h3",{children:"🔗 Unirse a partida"}),e.jsx("p",{children:"Ingresa un código de 6 dígitos para unirte"}),e.jsxs("div",{className:"join-form",children:[e.jsx("input",{type:"text",placeholder:"Ingresa el código de la partida",value:m,onChange:a=>N(a.target.value),maxLength:"6",className:"game-code-input"}),e.jsx("button",{onClick:I,className:"btn btn-secondary",children:"Unirse"})]})]})]}),e.jsxs("div",{className:"public-games-section",children:[e.jsx("h3",{children:"🌐 Partidas públicas"}),e.jsx("p",{children:"Únete a partidas abiertas para todos"}),e.jsx("div",{className:"games-list",children:!Array.isArray(p)||p.length===0?e.jsx("p",{className:"no-games",children:"No hay partidas públicas disponibles por ahora"}):p.map(a=>{var n,t,o;return e.jsxs("div",{className:"game-card",children:[e.jsxs("div",{className:"game-info",children:[e.jsxs("h4",{children:["Partida #",a.id]}),e.jsxs("p",{children:["Jugadores: ",((n=a.players)==null?void 0:n.length)||0]}),e.jsxs("p",{children:["Anfitrión: ",((o=(t=a.players)==null?void 0:t[0])==null?void 0:o.displayName)||"Desconocido"]})]}),e.jsx("button",{onClick:()=>P(a.id),className:"btn btn-primary",children:"Unirse"})]},a.id)})})]})]}),C&&e.jsx(r.Suspense,{fallback:e.jsx("div",{children:"Cargando generador de preguntas..."}),children:e.jsx($,{onQuestionsGenerated:a=>{k(a),g(!1)},onClose:()=>g(!1)})})]})}export{L as default};
//# sourceMappingURL=DashboardPage-Cxijj56X.js.map
