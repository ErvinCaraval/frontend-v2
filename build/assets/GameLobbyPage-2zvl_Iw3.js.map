{"version":3,"file":"GameLobbyPage-2zvl_Iw3.js","sources":["../../src/pages/GameLobbyPage.jsx"],"sourcesContent":["import React, { useEffect, useState } from 'react';\nimport { useParams, useNavigate } from 'react-router-dom';\nimport { useAuth } from '../AuthContext';\nimport { socket } from '../services/socket';\nimport './GameLobbyPage.css';\n\nexport default function GameLobbyPage() {\n  const { gameId } = useParams();\n  const { user } = useAuth();\n  const [players, setPlayers] = useState([]);\n  const [hostId, setHostId] = useState(null);\n  const [status, setStatus] = useState('waiting');\n  const [error, setError] = useState('');\n  const navigate = useNavigate();\n\n  useEffect(() => {\n    if (!user) return;\n    \n    socket.connect();\n    socket.emit('joinGame', { \n      gameId, \n      uid: user.uid, \n      displayName: user.displayName || user.email \n    });\n    \n    socket.on('playerJoined', ({ players }) => {\n      setPlayers(players);\n      if (players.length > 0) setHostId(players[0].uid);\n    });\n    \n    socket.on('gameStarted', () => {\n      console.log('[GameLobbyPage] Evento gameStarted recibido, navegando a /game/' + gameId);\n      navigate(`/game/${gameId}`);\n    });\n    \n    socket.on('error', ({ error }) => {\n      setError(error);\n    });\n\n    return () => {\n      socket.off('playerJoined');\n      socket.off('gameStarted');\n      socket.off('error');\n      socket.disconnect();\n    };\n  }, [gameId, user, navigate]);\n\n  const handleStart = () => {\n    console.log('[GameLobbyPage] Emitiendo startGame:', { gameId });\n    socket.emit('startGame', { gameId });\n  };\n\n  const copyGameCode = () => {\n    navigator.clipboard.writeText(gameId);\n    alert('Game code copied to clipboard!');\n  };\n\n  if (error) {\n    return (\n      <div className=\"lobby-page error-page\">\n        <div className=\"lobby-overlay\" />\n        <div className=\"error-container\">\n          <h2>‚ùå Error</h2>\n          <p>{\n            error === 'Game already started'\n              ? 'La partida ya ha comenzado. No puedes unirte en este momento.'\n              : error\n          }</p>\n          <button onClick={() => navigate('/dashboard')} className=\"btn btn-primary\">\n            Volver al inicio\n          </button>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"lobby-page\">\n      <div className=\"lobby-overlay\" />\n      <div className=\"lobby-container\">\n        <header className=\"lobby-header\">\n          <h1>üéÆ Sala de Juego</h1>\n          <div className=\"game-code-section\">\n            <h3>C√≥digo de la partida</h3>\n            <div className=\"game-code-display\">\n              <span className=\"game-code\">{gameId}</span>\n              <button onClick={copyGameCode} className=\"copy-btn\">\n                üìã Copiar\n              </button>\n            </div>\n            <p className=\"share-text\">¬°Comparte este c√≥digo con tus amigos para que se unan!</p>\n          </div>\n        </header>\n\n        <main className=\"lobby-main\">\n          <div className=\"players-section\">\n            <h3>üë• Jugadores ({players.length})</h3>\n            <div className=\"players-list\">\n              {players.map((player, index) => (\n                <div key={player.uid} className={`player-card${player.uid === hostId ? ' host' : ''}`}> {/* Espaciado fijo */}\n                  <div className=\"player-avatar\">\n                    {player.uid === hostId ? 'üëë' : 'üë§'}\n                  </div>\n                  <div className=\"player-info\">\n                    <span className=\"player-name\">\n                      {player.displayName || player.email}\n                    </span>\n                    {player.uid === hostId && (\n                      <span className=\"host-badge\">Anfitri√≥n</span>\n                    )}\n                  </div>\n                </div>\n              ))}\n            </div>\n          </div>\n\n          <div className=\"game-controls\">\n            {user && user.uid === hostId && status === 'waiting' ? (\n              <div className=\"host-controls\">\n                <p>¬øListo para comenzar la partida?</p>\n                <button \n                  onClick={handleStart} \n                  className=\"btn btn-primary btn-large\"\n                  disabled={players.length < 1}\n                >\n                  üöÄ Iniciar partida\n                </button>\n                {players.length < 1 && (\n                  <p className=\"waiting-text\">Esperando a que se unan jugadores...</p>\n                )}\n              </div>\n            ) : (\n              <div className=\"waiting-controls\">\n                <p>‚è≥ Esperando a que el anfitri√≥n inicie la partida...</p>\n                <div className=\"loading-dots\">\n                  <span></span>\n                  <span></span>\n                  <span></span>\n                </div>\n              </div>\n            )}\n          </div>\n        </main>\n      </div>\n    </div>\n  );\n}"],"names":["GameLobbyPage","gameId","useParams","user","useAuth","players","setPlayers","useState","hostId","setHostId","status","setStatus","error","setError","navigate","useNavigate","useEffect","socket","handleStart","copyGameCode","jsxs","jsx","player","index"],"mappings":"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"}