import{e as j,u as g,r as n,a as b,j as e}from"./index-D5d0iPnG.js";import{s}from"./socket-q9tp1uyO.js";function S(){const{gameId:i}=j(),{user:r}=g(),[t,c]=n.useState([]),[o,m]=n.useState(null),[h,N]=n.useState("waiting"),[d,p]=n.useState(""),l=b();n.useEffect(()=>{if(r)return s.connect(),s.emit("joinGame",{gameId:i,uid:r.uid,displayName:r.displayName||r.email}),s.on("playerJoined",({players:a})=>{c(a),a.length>0&&m(a[0].uid)}),s.on("gameStarted",()=>{console.log("[GameLobbyPage] Evento gameStarted recibido, navegando a /game/"+i),l(`/game/${i}`)}),s.on("error",({error:a})=>{p(a)}),()=>{s.off("playerJoined"),s.off("gameStarted"),s.off("error"),s.disconnect()}},[i,r,l]);const x=()=>{console.log("[GameLobbyPage] Emitiendo startGame:",{gameId:i}),s.emit("startGame",{gameId:i})},u=()=>{navigator.clipboard.writeText(i),alert("Game code copied to clipboard!")};return d?e.jsxs("div",{className:"lobby-page error-page",children:[e.jsx("div",{className:"lobby-overlay"}),e.jsxs("div",{className:"error-container",children:[e.jsx("h2",{children:"❌ Error"}),e.jsx("p",{children:d==="Game already started"?"La partida ya ha comenzado. No puedes unirte en este momento.":d}),e.jsx("button",{onClick:()=>l("/dashboard"),className:"btn btn-primary",children:"Volver al inicio"})]})]}):e.jsxs("div",{className:"lobby-page",children:[e.jsx("div",{className:"lobby-overlay"}),e.jsxs("div",{className:"lobby-container",children:[e.jsxs("header",{className:"lobby-header",children:[e.jsx("h1",{children:"🎮 Sala de Juego"}),e.jsxs("div",{className:"game-code-section",children:[e.jsx("h3",{children:"Código de la partida"}),e.jsxs("div",{className:"game-code-display",children:[e.jsx("span",{className:"game-code",children:i}),e.jsx("button",{onClick:u,className:"copy-btn",children:"📋 Copiar"})]}),e.jsx("p",{className:"share-text",children:"¡Comparte este código con tus amigos para que se unan!"})]})]}),e.jsxs("main",{className:"lobby-main",children:[e.jsxs("div",{className:"players-section",children:[e.jsxs("h3",{children:["👥 Jugadores (",t.length,")"]}),e.jsx("div",{className:"players-list",children:t.map((a,v)=>e.jsxs("div",{className:`player-card${a.uid===o?" host":""}`,children:[" ",e.jsx("div",{className:"player-avatar",children:a.uid===o?"👑":"👤"}),e.jsxs("div",{className:"player-info",children:[e.jsx("span",{className:"player-name",children:a.displayName||a.email}),a.uid===o&&e.jsx("span",{className:"host-badge",children:"Anfitrión"})]})]},a.uid))})]}),e.jsx("div",{className:"game-controls",children:r&&r.uid===o&&h==="waiting"?e.jsxs("div",{className:"host-controls",children:[e.jsx("p",{children:"¿Listo para comenzar la partida?"}),e.jsx("button",{onClick:x,className:"btn btn-primary btn-large",disabled:t.length<1,children:"🚀 Iniciar partida"}),t.length<1&&e.jsx("p",{className:"waiting-text",children:"Esperando a que se unan jugadores..."})]}):e.jsxs("div",{className:"waiting-controls",children:[e.jsx("p",{children:"⏳ Esperando a que el anfitrión inicie la partida..."}),e.jsxs("div",{className:"loading-dots",children:[e.jsx("span",{}),e.jsx("span",{}),e.jsx("span",{})]})]})})]})]})]})}export{S as default};
//# sourceMappingURL=GameLobbyPage-2zvl_Iw3.js.map
